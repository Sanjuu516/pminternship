<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile - PM Internship Portal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* Modern UI Color Scheme */
        :root {
            --primary-brand: #4F46E5; /* Indigo */
            --primary-brand-light: #6366F1;
            --primary-brand-dark: #4338CA;
            --secondary-accent: #10B981; /* Emerald */
            --secondary-accent-dark: #059669;
            --bg-main: #F8F9FA; /* Very light gray */
            --bg-card: #FFFFFF;
            --text-primary: #1F2937; /* Dark gray */
            --text-secondary: #6B7280; /* Medium gray */
            --text-light: #F9FAFB;
            --border-color: #E5E7EB;
            --error-color: #EF4444;
            --success-color: #10B981;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --border-radius-md: 0.5rem; /* 8px */
            --border-radius-lg: 0.75rem; /* 12px */
            --border-radius-xl: 1rem; /* 16px */
            --primary-gradient: linear-gradient(135deg, var(--primary-brand-light) 0%, var(--primary-brand) 100%);
            --accent-gradient: linear-gradient(135deg, var(--secondary-accent) 0%, var(--secondary-accent-dark) 100%);
            
            /* New colors from second file for consistency */
            --saffron: #FF9933;
            --ashoka-blue: #000080;
            --secondary-blue: #1e3a8a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: none;
        }
        
        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-main);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        /* --- Header --- */
        .header {
            position: fixed;
            top: 0; left: 0; width: 100%;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
            text-decoration: none;
            font-family: 'Roboto Slab', serif;
        }
        
        .logo-icon {
            color: var(--ashoka-blue);
            font-size: 1.8rem;
        }
        
        .profile-header { display: flex; align-items: center; gap: 0.75rem; }
        
        .profile-avatar {
            width: 40px; height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--ashoka-blue) 0%, var(--secondary-blue) 100%);
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 700; font-size: 1.2rem;
            font-family: 'Roboto Slab', serif;
        }
        
        .profile-info h3 { font-size: 1rem; font-weight: 600; }
        .profile-info p { font-size: 0.8rem; color: var(--text-secondary); }
        
        /* --- Main Content --- */
        .main-content {
            padding-top: 110px;
            padding-bottom: 4rem;
        }
        
        .page-title { text-align: center; margin-bottom: 3rem; }
        .page-title h1 {
            font-size: 2.8rem; font-weight: 800;
            margin-bottom: 0.5rem;
        }
        .gradient-text {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .page-title p {
            font-size: 1.1rem; color: var(--text-secondary);
            max-width: 600px; margin: 0 auto;
        }

        /* --- Section Styling --- */
        .profile-section {
            background: var(--bg-card);
            border-radius: var(--border-radius-xl);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
        }
        .profile-section.section-error {
            border-color: var(--error-color);
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.3);
            animation: shake 0.5s ease-in-out;
        }
        
        .section-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .section-title {
            display: flex; align-items: center; gap: 1rem;
            font-size: 1.4rem; font-weight: 700;
        }
        
        .section-icon {
            width: 40px; height: 40px;
            background: linear-gradient(135deg, var(--ashoka-blue) 0%, var(--secondary-blue) 100%);
            border-radius: var(--border-radius-md);
            display: flex; align-items: center; justify-content: center;
            color: white; font-size: 1.2rem;
        }
        
        .section-content { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
        @media (min-width: 768px) {
            .section-content.grid-2 { grid-template-columns: repeat(2, 1fr); }
        }

        /* --- Form Elements --- */
        .info-item { display: flex; flex-direction: column; gap: 0.5rem; }
        
        .info-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
        }
        
        .info-value {
            font-size: 1rem; color: var(--text-primary); font-weight: 500;
            min-height: 2.5rem; background: var(--bg-main);
            padding: 0.75rem; border-radius: var(--border-radius-md);
            border: 1px solid var(--border-color);
        }
        .empty-value { color: var(--text-secondary); font-style: italic; }

        .info-input, select.info-input {
            width: 100%; padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 1rem; font-family: 'Inter', sans-serif;
            background: white;
            transition: all 0.2s ease;
        }
        .info-input:focus {
            outline: none;
            border-color: var(--primary-brand);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
        }

        /* --- Buttons --- */
        .btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;
            padding: 0.65rem 1.25rem; font-size: 0.9rem; font-weight: 600;
            border: none; border-radius: var(--border-radius-md); cursor: pointer;
            transition: all 0.2s ease; text-decoration: none;
        }
        .btn-primary { background: var(--primary-brand); color: white; }
        .btn-primary:hover { background: var(--primary-brand-dark); transform: translateY(-2px); }
        
        .btn-secondary { background: var(--bg-main); color: var(--text-primary); border: 1px solid var(--border-color); }
        .btn-secondary:hover { background: var(--border-color); }
        
        .btn-danger { background: #fee2e2; color: #b91c1c; }
        .btn-danger:hover { background: #fecaca; }
        
        .btn-save {
            background: var(--accent-gradient); color: white;
            padding: 0.8rem 2rem; font-size: 1rem;
            box-shadow: var(--shadow-md);
        }
        .btn-save:hover { transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        .btn-save:disabled { background: #D1D5DB; cursor: not-allowed; transform: none; box-shadow: none; }


        /* --- Multi-Select Component --- */
        .tags-container { display: flex; flex-wrap: wrap; gap: 0.5rem; padding: 0.5rem 0; }
        .tag {
            padding: 0.4rem 0.9rem; border-radius: 50px;
            background: var(--bg-main); color: var(--text-secondary);
            cursor: pointer; transition: all 0.2s ease; font-weight: 500;
            border: 1px solid var(--border-color);
        }
        .tag.selected {
            background: var(--primary-brand); color: white; border-color: var(--primary-brand);
            box-shadow: var(--shadow-sm);
        }
        .other-input-container { display: flex; gap: 1rem; align-items: center; margin-top: 1rem;}
        .other-input-container input { flex-grow: 1; }
        
        /* Education List */
        .education-entry {
            background: var(--bg-main);
            padding: 1.5rem;
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--border-color);
            margin-bottom: 1rem;
            position: relative;
        }
        .education-entry-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        @media (max-width: 500px) {
            .education-entry-grid { grid-template-columns: 1fr; }
        }
        .remove-education-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
        }

        /* --- Popups and Animations --- */
        .validation-message {
            position: fixed; top: 90px; left: 50%;
            transform: translateX(-50%);
            color: white; padding: 0.8rem 1.5rem;
            border-radius: var(--border-radius-md); font-weight: 600;
            box-shadow: var(--shadow-lg);
            z-index: 1001; opacity: 0;
            animation: fadeInOut 4s ease;
        }
        
        @keyframes shake {
            10%, 90% { transform: translateX(-5px); }
            20%, 80% { transform: translateX(5px); }
            30%, 50%, 70% { transform: translateX(-3px); }
            40%, 60% { transform: translateX(3px); }
        }
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translate(-50%, -20px); }
            10%, 90% { opacity: 1; transform: translate(-50%, 0); }
        }

        /* Cursor styles from the second file */
        .custom-cursor {
            position: fixed;
            width: 40px;
            height: 40px;
            z-index: 10005;
            pointer-events: none;
            transform: translate(-50%, -50%);
            transition: transform 0.1s ease;
        }

        .pen-cursor {
            font-size: 40px;
            color: var(--saffron);
            animation: pulse 2s infinite;
            filter: drop-shadow(0 0 15px rgba(255, 153, 51, 0.9));
        }

        /* Floating Particles Background Logic */
        .particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: var(--ashoka-blue);
            border-radius: 50%;
            opacity: 0.3;
            animation: float-particle 15s infinite linear;
        }
        
        /* Multi-Glow Background Orbs from the second file */
        .glow-orbs {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .glow-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            animation: float-orb 20s infinite ease-in-out;
        }

        .glow-orb-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(0, 0, 128, 0.8) 0%, rgba(0, 0, 128, 0) 70%);
            top: -200px;
            left: -200px;
            animation-duration: 25s;
        }

        .glow-orb-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(255, 153, 51, 0.8) 0%, rgba(255, 153, 51, 0) 70%);
            bottom: -150px;
            right: -150px;
            animation-duration: 30s;
            animation-delay: 2s;
        }

        .glow-orb-3 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(0, 0, 128, 0.8) 0%, rgba(0, 0, 128, 0) 70%);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-duration: 35s;
            animation-delay: 5s;
        }

        /* Animation Keyframes from the second file */
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }

        @keyframes float-particle {
            0% {
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 0.4;
            }
            90% {
                opacity: 0.4;
            }
            100% {
                transform: translateY(-100vh) translateX(100px);
                opacity: 0;
            }
        }

        @keyframes float-orb {
            0%, 100% {
                transform: translate(0, 0) scale(1);
            }
            33% {
                transform: translate(30px, -30px) scale(1.1);
            }
            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }
        }

    </style>
</head>
<body>
    <div class="particles-container"></div>
    <div class="glow-orbs">
        <div class="glow-orb glow-orb-1"></div>
        <div class="glow-orb glow-orb-2"></div>
        <div class="glow-orb glow-orb-3"></div>
    </div>
    <div class="custom-cursor">
        <i class="fas fa-pen pen-cursor"></i>
    </div>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- DATA CONSTANTS ---
        const SKILL_OPTIONS = ["Communication", "Teamwork", "Problem Solving", "Leadership", "Microsoft Office", "Data Entry", "Digital Marketing", "Customer Service", "Content Writing", "Typing"];
        const SECTOR_OPTIONS = ["IT", "Healthcare", "Agriculture", "Education", "Finance", "Government", "Manufacturing", "Retail", "Social Work", "Tourism"];
        const LOCATION_OPTIONS = ["Andhra Pradesh", "Arunachal Pradesh", "Assam", "Bihar", "Chhattisgarh", "Delhi", "Goa", "Gujarat", "Haryana", "Himachal Pradesh", "Jammu and Kashmir", "Jharkhand", "Karnataka", "Kerala", "Madhya Pradesh", "Maharashtra", "Manipur", "Meghalaya", "Mizoram", "Nagaland", "Odisha", "Punjab", "Rajasthan", "Sikkim", "Tamil Nadu", "Telangana", "Tripura", "Uttar Pradesh", "Uttarakhand", "West Bengal", "Other"];
        const DURATION_OPTIONS = ["1 Month", "2 Months", "3 Months", "4-6 Months", "6+ Months"];
        const MODE_OPTIONS = ["Work from Office (Offline)", "Work from Home (Online)", "Hybrid (Online + Offline)"];

        // --- Reusable UI Components ---
        const InfoItemDisplay = ({ label, value, emptyText = "Not specified" }) => {
            const displayValue = Array.isArray(value) ? (value.length > 0 ? value.join(', ') : emptyText) : (value || emptyText);
            return (
                <div className="info-item">
                    <div className="info-label">{label}</div>
                    <div className={`info-value ${!value || (Array.isArray(value) && value.length === 0) ? 'empty-value' : ''}`}>
                        {displayValue}
                    </div>
                </div>
            );
        };

        const MultiSelectEditor = ({ label, options, selected, onToggle, onAddOther }) => {
            const [otherValue, setOtherValue] = useState('');

            const handleAddClick = () => {
                if(otherValue.trim() && !selected.includes(otherValue.trim())) {
                    onAddOther(otherValue.trim());
                    setOtherValue('');
                }
            };
            
            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    handleAddClick();
                }
            };

            return (
                <div className="info-item">
                    <div className="info-label">{label}</div>
                    <div className="tags-container">
                        {options.map(option => (
                            <div key={option} className={`tag ${selected.includes(option) ? 'selected' : ''}`} onClick={() => onToggle(option)}>
                                {option}
                            </div>
                        ))}
                        {selected.filter(s => !options.includes(s)).map(customOption => (
                             <div key={customOption} className="tag selected" onClick={() => onToggle(customOption)}>
                                {customOption} <i className="fas fa-times fa-xs" style={{marginLeft: '8px'}}></i>
                            </div>
                        ))}
                    </div>
                    <div className="info-label" style={{marginTop: '1rem'}}>Not listed? Add your own.</div>
                    <div className="other-input-container">
                        <input
                            type="text"
                            className="info-input"
                            placeholder="Type here and click Add..."
                            value={otherValue}
                            onChange={e => setOtherValue(e.target.value)}
                            onKeyPress={handleKeyPress}
                        />
                        <button className="btn btn-primary" onClick={handleAddClick}>Add</button>
                    </div>
                </div>
            );
        };

        // --- Section Components ---
        const BasicDetailsSection = ({ data, onChange, isEditing, setEditing }) => (
            <div className="profile-section">
                <div className="section-header">
                    <div className="section-title"><div className="section-icon"><i className="fas fa-user-circle"></i></div><span>Basic Details</span></div>
                    <button className="btn btn-secondary" onClick={() => setEditing(!isEditing)}>
                        <i className={`fas ${isEditing ? 'fa-times' : 'fa-edit'}`}></i> {isEditing ? 'Cancel' : 'Edit'}
                    </button>
                </div>
                <div className="section-content grid-2">
                    <InfoItemDisplay label="Full Name (from registration)" value={data.name} />
                    <InfoItemDisplay label="Email (from registration)" value={data.email} />
                    {isEditing ? (
                        <>
                            <div className="info-item">
                                <div className="info-label">Contact Number</div>
                                <input type="tel" className="info-input" placeholder="e.g., 9876543210" value={data.phone} onChange={e => onChange('phone', e.target.value)} />
                            </div>
                            <div className="info-item">
                                <div className="info-label">Current State / Union Territory</div>
                                <select className="info-input" value={data.state} onChange={e => onChange('state', e.target.value)}>
                                    <option value="">-- Select your location --</option>
                                    {LOCATION_OPTIONS.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                                </select>
                            </div>
                            <div className="info-item">
                                <div className="info-label">District / City</div>
                                <input type="text" className="info-input" placeholder="e.g., Mumbai" value={data.district} onChange={e => onChange('district', e.target.value)} />
                            </div>
                        </>
                    ) : (
                        <>
                            <InfoItemDisplay label="Contact Number" value={data.phone} />
                            <InfoItemDisplay label="Location" value={`${data.district || ''}${data.district && data.state ? ', ' : ''}${data.state || ''}`} />
                        </>
                    )}
                </div>
            </div>
        );

        const EducationSection = ({ data, onChange, isEditing, setEditing }) => {
            const handleEntryChange = (index, field, value) => {
                const updatedEntries = [...data];
                updatedEntries[index][field] = value;
                onChange(updatedEntries);
            };

            const addEntry = () => {
                onChange([...data, { institution: '', degree: '', year: '' }]);
            };

            const removeEntry = (index) => {
                onChange(data.filter((_, i) => i !== index));
            };

            return (
                <div className="profile-section">
                    <div className="section-header">
                        <div className="section-title"><div className="section-icon"><i className="fas fa-graduation-cap"></i></div><span>Education</span></div>
                        <button className="btn btn-secondary" onClick={() => setEditing(!isEditing)}>
                            <i className={`fas ${isEditing ? 'fa-times' : 'fa-edit'}`}></i> {isEditing ? 'Cancel' : 'Edit'}
                        </button>
                    </div>
                    <div className="section-content">
                        {isEditing ? (
                            <>
                                {data.map((entry, index) => (
                                    <div key={index} className="education-entry">
                                        <button className="btn btn-danger remove-education-btn" onClick={() => removeEntry(index)}><i className="fas fa-trash"></i></button>
                                        <div className="education-entry-grid">
                                            <div className="info-item">
                                                <div className="info-label">Institution / College Name</div>
                                                <input type="text" className="info-input" placeholder="e.g., University of Delhi" value={entry.institution} onChange={e => handleEntryChange(index, 'institution', e.target.value)} />
                                            </div>
                                            <div className="info-item">
                                                <div className="info-label">Course / Degree</div>
                                                <input type="text" className="info-input" placeholder="e.g., Bachelor of Arts" value={entry.degree} onChange={e => handleEntryChange(index, 'degree', e.target.value)} />
                                            </div>
                                            <div className="info-item">
                                                <div className="info-label">Year of Completion / Current Year</div>
                                                <input type="text" className="info-input" placeholder="e.g., 2024 or 3rd Year" value={entry.year} onChange={e => handleEntryChange(index, 'year', e.target.value)} />
                                            </div>
                                        </div>
                                    </div>
                                ))}
                                <button className="btn btn-primary" onClick={addEntry}><i className="fas fa-plus"></i> Add Another Qualification</button>
                            </>
                        ) : (
                            data.length > 0 ? data.map((entry, index) => (
                                <InfoItemDisplay 
                                    key={index}
                                    label={`Qualification #${index + 1}`}
                                    value={`${entry.degree || 'N/A'} from ${entry.institution || 'N/A'} (${entry.year || 'N/A'})`}
                                />
                            )) : <InfoItemDisplay label="Education" value="" />
                        )}
                    </div>
                </div>
            );
        };
        
        const SkillsSection = ({ data, onChange, isEditing, setEditing }) => (
            <div className="profile-section">
                <div className="section-header">
                    <div className="section-title"><div className="section-icon"><i className="fas fa-tools"></i></div><span>Skills</span></div>
                    <button className="btn btn-secondary" onClick={() => setEditing(!isEditing)}>
                        <i className={`fas ${isEditing ? 'fa-times' : 'fa-edit'}`}></i> {isEditing ? 'Cancel' : 'Edit'}
                    </button>
                </div>
                <div className="section-content">
                    {isEditing ? (
                            <MultiSelectEditor
                                label="Select your skills (both technical and non-technical)"
                                options={SKILL_OPTIONS}
                                selected={data}
                                onToggle={skill => onChange(data.includes(skill) ? data.filter(s => s !== skill) : [...data, skill])}
                                onAddOther={skill => onChange([...data, skill])}
                            />
                    ) : (
                        <InfoItemDisplay label="Your Skills" value={data} emptyText="No skills added yet" />
                    )}
                </div>
            </div>
        );

        const InterestsSection = ({ data, onChange, isEditing, setEditing }) => (
            <div className="profile-section">
                <div className="section-header">
                    <div className="section-title"><div className="section-icon"><i className="fas fa-building"></i></div><span>Sector Interests</span></div>
                    <button className="btn btn-secondary" onClick={() => setEditing(!isEditing)}>
                        <i className={`fas ${isEditing ? 'fa-times' : 'fa-edit'}`}></i> {isEditing ? 'Cancel' : 'Edit'}
                    </button>
                </div>
                <div className="section-content">
                    {isEditing ? (
                            <MultiSelectEditor
                                label="Which work areas are you most interested in?"
                                options={SECTOR_OPTIONS}
                                selected={data}
                                onToggle={sector => onChange(data.includes(sector) ? data.filter(s => s !== sector) : [...data, sector])}
                                onAddOther={sector => onChange([...data, sector])}
                            />
                    ) : (
                        <InfoItemDisplay label="Interested Sectors" value={data} emptyText="No interests added yet" />
                    )}
                </div>
            </div>
        );

        const PreferencesSection = ({ data, onChange, isEditing, setEditing }) => (
            <div className="profile-section">
                <div className="section-header">
                    <div className="section-title"><div className="section-icon"><i className="fas fa-sliders-h"></i></div><span>Internship Preferences</span></div>
                    <button className="btn btn-secondary" onClick={() => setEditing(!isEditing)}>
                        <i className={`fas ${isEditing ? 'fa-times' : 'fa-edit'}`}></i> {isEditing ? 'Cancel' : 'Edit'}
                    </button>
                </div>
                <div className="section-content grid-2">
                    {isEditing ? (
                        <>
                            <div className="info-item">
                                <div className="info-label">Preferred Work Mode</div>
                                <select className="info-input" value={data.mode} onChange={e => onChange('mode', e.target.value)}>
                                    <option value="">-- Select Mode --</option>
                                    {MODE_OPTIONS.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                                </select>
                            </div>
                            <div className="info-item">
                                <div className="info-label">Preferred Duration</div>
                                <select className="info-input" value={data.duration} onChange={e => onChange('duration', e.target.value)}>
                                    <option value="">-- Select Duration --</option>
                                    {DURATION_OPTIONS.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                                </select>
                            </div>
                        </>
                    ) : (
                        <>
                            <InfoItemDisplay label="Preferred Work Mode" value={data.mode} />
                            <InfoItemDisplay label="Preferred Duration" value={data.duration} />
                        </>
                    )}
                </div>
            </div>
        );

        // --- MAIN APP COMPONENT ---
        const ProfilePage = () => {
            const [profile, setProfile] = useState({
                basicDetails: { name: '', email: '', phone: '', district: '', state: '' },
                education: [],
                skills: [],
                sectorInterests: [],
                internshipPreferences: { mode: '', duration: '' },
            });
            
            const [editing, setEditing] = useState({
                basicDetails: false, education: false, skills: false, sectorInterests: false, internshipPreferences: false
            });

            const [validationStatus, setValidationStatus] = useState({ section: '', message: '' });
            const [isSaving, setIsSaving] = useState(false);
            
            const sectionRefs = {
                basicDetails: useRef(null), education: useRef(null), skills: useRef(null), 
                sectorInterests: useRef(null), internshipPreferences: useRef(null)
            };
            
            // --- Effects ---
            useEffect(() => {
                const storedUserName = localStorage.getItem('userName') || 'User';
                const storedUserEmail = localStorage.getItem('userEmail') || '';
                
                const savedProfile = localStorage.getItem(`profile_v2_${storedUserEmail}`);
                
                if (savedProfile) {
                    try {
                        const parsed = JSON.parse(savedProfile);
                        setProfile(parsed);
                        // Start with all sections in view mode
                        setEditing({ basicDetails: false, education: false, skills: false, sectorInterests: false, internshipPreferences: false });
                    } catch (e) {
                        console.error("Failed to parse profile", e);
                        // Fallback for first time or corrupted data
                        setProfile(prev => ({ ...prev, basicDetails: { ...prev.basicDetails, name: storedUserName, email: storedUserEmail } }));
                        setEditing({ basicDetails: true, education: true, skills: true, sectorInterests: true, internshipPreferences: true });
                    }
                } else {
                    // First time user, open all sections for editing
                    setProfile(prev => ({ ...prev, basicDetails: { ...prev.basicDetails, name: storedUserName, email: storedUserEmail } }));
                    setEditing({ basicDetails: true, education: true, skills: true, sectorInterests: true, internshipPreferences: true });
                }
            }, []);

            // --- Event Handlers ---
            const handleProfileChange = (section, field, value) => {
                setProfile(prev => ({
                    ...prev,
                    [section]: {
                        ...prev[section],
                        [field]: value
                    }
                }));
            };
            
            const handleSectionChange = (section, value) => {
                setProfile(prev => ({ ...prev, [section]: value }));
                // Clear validation error for the section being edited
                if (validationStatus.section === section) {
                    setValidationStatus({ section: '', message: '' });
                }
            };
            
            const toggleSectionEditing = (section) => {
                setEditing(prev => ({ ...prev, [section]: !prev[section] }));
            };

            // --- Validation & Save ---
            const validateProfile = () => {
                const { basicDetails, education, skills, sectorInterests, internshipPreferences } = profile;
                if (!basicDetails.phone.trim() || !basicDetails.state.trim() || !basicDetails.district.trim()) return { section: 'basicDetails', message: 'Please complete all fields in Basic Details.' };
                if (education.length === 0 || education.some(e => !e.institution.trim() || !e.degree.trim() || !e.year.trim())) return { section: 'education', message: 'Please add at least one complete education entry.' };
                if (skills.length === 0) return { section: 'skills', message: 'Please select at least one skill.' };
                if (sectorInterests.length === 0) return { section: 'sectorInterests', message: 'Please select at least one sector of interest.' };
                if (!internshipPreferences.mode || !internshipPreferences.duration) return { section: 'internshipPreferences', message: 'Please select your internship preferences.' };
                return null;
            };

            const saveProfile = () => {
                const error = validateProfile();
                if (error) {
                    setValidationStatus(error);
                    sectionRefs[error.section].current?.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }

                setIsSaving(true);
                localStorage.setItem(`profile_v2_${profile.basicDetails.email}`, JSON.stringify(profile));
                
                setValidationStatus({ section: 'success', message: 'Profile saved successfully!' });
                setEditing({ basicDetails: false, education: false, skills: false, sectorInterests: false, internshipPreferences: false });

                setTimeout(() => {
                    setValidationStatus({ section: '', message: '' });
                    setIsSaving(false);
                }, 4000);
            };

            return (
                <div>
                    <header className="header">
                        <div className="container header-content">
                            <a href="plan.html" className="logo"><i className="fas fa-graduation-cap logo-icon"></i><span>PM INTERNSHIP</span></a>
                            <div className="profile-header">
                                <div className="profile-avatar">{profile.basicDetails.name?.charAt(0).toUpperCase() || 'U'}</div>
                                <div className="profile-info">
                                    <h3>{profile.basicDetails.name}</h3>
                                    <p>{profile.basicDetails.email}</p>
                                </div>
                            </div>
                        </div>
                    </header>
                    
                    <main className="main-content">
                        <div className="container">
                            <div className="page-title">
                                <h1>Build Your <span className="gradient-text">Career Profile</span></h1>
                                <p>Keep your info updated. This helps us find the best internship opportunities for you.</p>
                            </div>
                            
                            <div ref={sectionRefs.basicDetails} className={validationStatus.section === 'basicDetails' ? 'section-error' : ''}>
                                <BasicDetailsSection data={profile.basicDetails} onChange={(field, value) => handleProfileChange('basicDetails', field, value)} isEditing={editing.basicDetails} setEditing={() => toggleSectionEditing('basicDetails')} />
                            </div>
                            
                            <div ref={sectionRefs.education} className={validationStatus.section === 'education' ? 'section-error' : ''}>
                                <EducationSection data={profile.education} onChange={value => handleSectionChange('education', value)} isEditing={editing.education} setEditing={() => toggleSectionEditing('education')} />
                            </div>

                            <div ref={sectionRefs.skills} className={validationStatus.section === 'skills' ? 'section-error' : ''}>
                                <SkillsSection data={profile.skills} onChange={value => handleSectionChange('skills', value)} isEditing={editing.skills} setEditing={() => toggleSectionEditing('skills')} />
                            </div>

                            <div ref={sectionRefs.sectorInterests} className={validationStatus.section === 'sectorInterests' ? 'section-error' : ''}>
                                <InterestsSection data={profile.sectorInterests} onChange={value => handleSectionChange('sectorInterests', value)} isEditing={editing.sectorInterests} setEditing={() => toggleSectionEditing('sectorInterests')} />
                            </div>

                            <div ref={sectionRefs.internshipPreferences} className={validationStatus.section === 'internshipPreferences' ? 'section-error' : ''}>
                                <PreferencesSection data={profile.internshipPreferences} onChange={(field, value) => handleProfileChange('internshipPreferences', field, value)} isEditing={editing.internshipPreferences} setEditing={() => toggleSectionEditing('internshipPreferences')} />
                            </div>

                            <div style={{ display: 'flex', justifyContent: 'center', marginTop: '2rem' }}>
                                <button className="btn btn-save" onClick={saveProfile} disabled={isSaving}>
                                    <i className="fas fa-save"></i> {isSaving ? 'Saving...' : 'Save Profile'}
                                </button>
                            </div>
                        </div>
                    </main>

                    {validationStatus.message && (
                        <div className="validation-message" style={{ background: validationStatus.section === 'success' ? 'var(--success-color)' : 'var(--error-color)'}}>
                            {validationStatus.message}
                        </div>
                    )}
                </div>
            );
        };
        
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<ProfilePage />);
    </script>
    <script>
        // --- Non-React JavaScript for UI Enhancements ---
        
        // Custom Cursor Logic
        document.addEventListener('mousemove', (e) => {
            const cursor = document.querySelector('.custom-cursor');
            cursor.style.left = `${e.clientX}px`;
            cursor.style.top = `${e.clientY}px`;
        });

        // Floating Particles Background Logic
        const particlesContainer = document.querySelector('.particles-container');
        const createParticle = () => {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            const size = Math.random() * 6 + 2;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            
            particle.style.left = `${Math.random() * 100}%`;
            particle.style.top = `${Math.random() * 100}%`;
            
            const colors = [
                'rgba(0, 0, 128, 0.5)',
                'rgba(255, 153, 51, 0.5)',
                'rgba(0, 0, 128, 0.5)'
            ];
            particle.style.background = colors[Math.floor(Math.random() * colors.length)];
            
            const duration = Math.random() * 10 + 10;
            particle.style.animationDuration = `${duration}s`;
            
            particle.style.animationDelay = `${Math.random() * 5}s`;
            
            particlesContainer.appendChild(particle);
            
            setTimeout(() => {
                particle.remove();
            }, duration * 1000);
        };
        
        for (let i = 0; i < 30; i++) {
            setTimeout(createParticle, i * 100);
        }
        
        const particleInterval = setInterval(createParticle, 300);
        window.addEventListener('beforeunload', () => clearInterval(particleInterval));
    </script>
</body>
</html>
